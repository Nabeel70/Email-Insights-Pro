(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var s=r(5155),a=r(2115),n=r(9708),i=r(2085),d=r(9434);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:o=!1,...c}=e,u=o?n.DX:"button";return(0,s.jsx)(u,{className:(0,d.cn)(l({variant:a,size:i,className:r})),ref:t,...c})});o.displayName="Button"},1541:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,AuthProvider:()=>d});var s=r(5155),a=r(2115),n=r(9323);let i=(0,a.createContext)({user:null,loading:!0});function d(e){let{children:t}=e,[r,d]=(0,a.useState)(null),[l,o]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=(0,n.Bh)(e=>{d(e),o(!1)});return()=>e()},[]),(0,s.jsx)(i.Provider,{value:{user:r,loading:l},children:t})}let l=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},1920:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(157).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},2523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(5155),a=r(2115),n=r(9434);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},3920:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(157).A)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]])},4913:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(157).A)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},6104:(e,t,r)=>{"use strict";r.d(t,{db:()=>l,j:()=>d});var s=r(3915),a=r(4903),n=r(5317);let i=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)({apiKey:"AIzaSyDLtdLHWg5nW07lFUlcmqsa90WKjTHMtlM",authDomain:"email-insights-pro-lcd3q.firebaseapp.com",projectId:"email-insights-pro-lcd3q",storageBucket:"email-insights-pro-lcd3q.appspot.com",messagingSenderId:"56610768571",appId:"1:56610768571:web:04c62c52c047925da14b9e"}),d=(0,a.xI)(i),l=(0,n.aU)(i)},6126:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var s=r(5155);r(2115);var a=r(2085),n=r(9434);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:r}),t),...a})}},6365:(e,t,r)=>{"use strict";r.d(t,{C:()=>l});var s=r(5155),a=r(2115),n=r(5695),i=r(1541),d=r(4913);function l(e){let{children:t}=e,{user:r,loading:l}=(0,i.A)(),o=(0,n.useRouter)();return((0,a.useEffect)(()=>{l||r||o.push("/login")},[r,l,o]),l||!r)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(d.A,{className:"h-8 w-8 animate-spin"})}):(0,s.jsx)(s.Fragment,{children:t})}},6642:(e,t,r)=>{Promise.resolve().then(r.bind(r,8335))},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>l,Zp:()=>i,aR:()=>d});var s=r(5155),a=r(2115),n=r(9434);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});d.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},7481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>m});var s=r(2115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},d=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],o={toasts:[]};function c(e){o=d(o,e),l.forEach(e=>{e(o)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=s.useState(o);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},7554:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(157).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},8335:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var s=r(5155),a=r(6365),n=r(6695),i=r(285),d=r(2115),l=r(9434);let o=d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",r),...a})})});o.displayName="Table";let c=d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",r),...a})});c.displayName="TableHeader";let u=d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",r),...a})});u.displayName="TableBody",d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})}).displayName="TableFooter";let m=d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...a})});m.displayName="TableRow";let f=d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});f.displayName="TableHead";let x=d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});x.displayName="TableCell",d.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption";var h=r(6126),p=r(2523),b=r(5317),g=r(6104),y=r(4913),v=r(7554),j=r(3920),N=r(1920),w=r(9637);let S=(0,r(157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var k=r(7481);function A(){return(0,s.jsx)(a.C,{children:(0,s.jsx)(T,{})})}function T(){let[e,t]=(0,d.useState)([]),[r,a]=(0,d.useState)([]),[l,A]=(0,d.useState)(!0),[T,_]=(0,d.useState)(!1),[D,C]=(0,d.useState)(""),{toast:E}=(0,k.dj)(),R=(0,d.useMemo)(()=>D?e.filter(e=>{var t;let r=(null==(t=e.EMAIL)?void 0:t.toLowerCase())||"",s=D.toLowerCase();return r.includes(s)}):e,[e,D]),M=(0,d.useMemo)(()=>{let t=new Date;return t.setDate(t.getDate()-30),e.filter(e=>!!e.date_added&&new Date(e.date_added)>=t)},[e]),I=async()=>{try{let[e,r]=await Promise.all([(0,b.GG)((0,b.rJ)(g.db,"rawUnsubscribers")),(0,b.GG)((0,b.rJ)(g.db,"rawCampaigns"))]),s=e.docs.map(e=>e.data()).filter(e=>"unsubscribed"===e.status).sort((e,t)=>{let r=e.date_added?new Date(e.date_added).getTime():0;return(t.date_added?new Date(t.date_added).getTime():0)-r}),n=r.docs.map(e=>e.data());t(s),a(n)}catch(e){console.error("Failed to fetch unsubscribes:",e),E({title:"Failed to load unsubscribes",description:"Could not fetch unsubscribe data from Firestore.",variant:"destructive"})}finally{A(!1)}};(0,d.useEffect)(()=>{I()},[]);let L=async()=>{_(!0);try{let e=await fetch("/api/manual-sync",{method:"GET"}),t=await e.json();if(!e.ok)throw Error(t.error||"Sync failed due to server error.");E({title:"Sync Successful",description:t.message}),await I()}catch(t){console.error("Sync error:",t);let e=t instanceof Error?t.message:"An unknown error occurred";E({title:"Sync Failed",description:"Failed to complete data sync: ".concat(e),variant:"destructive"})}finally{_(!1)}},U=e=>{if(!e)return"Unknown";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return"Invalid Date"}};return l?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(y.A,{className:"h-8 w-8 animate-spin"})}):(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Unsubscribes"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"List unsubscribes from campaigns"})]}),(0,s.jsxs)(i.$,{onClick:L,disabled:T,variant:"outline",children:[(0,s.jsx)(v.A,{className:"h-4 w-4 mr-2 ".concat(T?"animate-spin":"")}),T?"Syncing...":"Sync Data"]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3 mb-6",children:[(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(n.ZB,{className:"text-sm font-medium",children:"Total Unsubscribes"}),(0,s.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(n.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.length.toLocaleString()}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(n.ZB,{className:"text-sm font-medium",children:"Recent Unsubscribes"}),(0,s.jsx)(N.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(n.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:M.length.toLocaleString()}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last 30 days"})]})]}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(n.ZB,{className:"text-sm font-medium",children:"Active Campaigns"}),(0,s.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(n.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:r.length.toLocaleString()}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total campaigns"})]})]})]}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(n.ZB,{children:"Unsubscribed Users"}),(0,s.jsx)(n.BT,{children:"Users who have unsubscribed from email campaigns"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(S,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)(p.p,{placeholder:"Search by email...",value:D,onChange:e=>C(e.target.value),className:"w-64"})]})]})}),(0,s.jsx)(n.Wu,{children:0===R.length?(0,s.jsx)("div",{className:"text-center py-8",children:0===e.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No unsubscribes found"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"No unsubscribe data is available. Try syncing data from EP MailPro."}),(0,s.jsx)(i.$,{onClick:L,disabled:T,children:T?"Syncing...":"Sync Unsubscribes"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No results found"}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:['No unsubscribes match your search term "',D,'"']})]})}):(0,s.jsxs)("div",{className:"rounded-md border",children:[(0,s.jsxs)(o,{children:[(0,s.jsx)(c,{children:(0,s.jsxs)(m,{children:[(0,s.jsx)(f,{children:"Email"}),(0,s.jsx)(f,{children:"Status"}),(0,s.jsx)(f,{children:"Date Unsubscribed"}),(0,s.jsx)(f,{children:"Subscriber ID"})]})}),(0,s.jsx)(u,{children:R.map(e=>(0,s.jsxs)(m,{children:[(0,s.jsx)(x,{className:"font-medium",children:e.EMAIL||"No email provided"}),(0,s.jsx)(x,{children:(0,s.jsx)(h.E,{variant:"unsubscribed"===e.status?"destructive":"secondary",children:e.status})}),(0,s.jsx)(x,{className:"text-muted-foreground",children:U(e.date_added)}),(0,s.jsx)(x,{className:"text-xs text-muted-foreground font-mono",children:e.subscriber_uid})]},e.subscriber_uid))})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",R.length," of ",e.length," unsubscribes"]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:D&&'Filtered by: "'.concat(D,'"')})]})]})})]})]})}},9323:(e,t,r)=>{"use strict";r.d(t,{Bh:()=>d,CI:()=>i,Jv:()=>n});var s=r(4903),a=r(6104);let n=(e,t)=>(0,s.x9)(a.j,e,t),i=()=>(0,s.CI)(a.j),d=e=>(0,s.hg)(a.j,e)},9434:(e,t,r)=>{"use strict";r.d(t,{b:()=>i,cn:()=>n});var s=r(2596),a=r(9688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}function i(e){if(!e||""===e.trim()||e.startsWith("0000-00-00"))return"N/A";try{let t=new Date(e);if(isNaN(t.getTime())){let t=new Date(e.replace(" ","T"));if(isNaN(t.getTime()))return"N/A";return t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}return t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(t){return console.error("Could not parse date: ".concat(e),t),"N/A"}}},9637:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(157).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[135,210,553,441,684,358],()=>t(6642)),_N_E=e.O()}]);
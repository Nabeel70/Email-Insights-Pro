(()=>{var e={};e.id=941,e.ids=[941],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21546:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>F});var t=r(60687),i=r(78933),a=r(43210),n=r(52579),o=r(82614);let l=(0,o.A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var d=r(77368),c=r(49497),u=r(93090);let x=(0,o.A)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),p=(0,o.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var h=r(29523),m=r(63523),b=r(16189),j=r(29867),f=r(44493),v=r(6211),g=r(89667),y=r(42692),q=r(20620),w=r(49589),k=r(36644),N=r(54690),A=r(21342),_=r(53691),C=r(4780);function P({data:e}){let[s,r]=(0,a.useState)(""),i=(0,a.useMemo)(()=>s?e.filter(e=>e.EMAIL?.toLowerCase().includes(s.toLowerCase())):e,[e,s]),n=(0,a.useMemo)(()=>i.map(e=>({email:e.EMAIL??"N/A",unsubscribe_date:(0,C.b)(e.date_added),status:e.status})),[i]);return(0,t.jsxs)(f.Zp,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,t.jsx)("div",{className:"w-full max-w-sm",children:(0,t.jsx)(g.p,{placeholder:"Filter by email...",value:s,onChange:e=>r(e.target.value),className:"w-full"})}),(0,t.jsxs)(A.rI,{children:[(0,t.jsx)(A.ty,{asChild:!0,children:(0,t.jsxs)(h.$,{variant:"outline",children:[(0,t.jsx)(q.A,{className:"mr-2 h-4 w-4"}),"Export Data"]})}),(0,t.jsxs)(A.SQ,{children:[(0,t.jsxs)(A._2,{onClick:()=>(0,_.FK)(n,"unsubscribes.json"),children:[(0,t.jsx)(w.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Export as JSON"})]}),(0,t.jsxs)(A._2,{onClick:()=>(0,_.VI)(n,"unsubscribes.csv"),children:[(0,t.jsx)(k.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Export as CSV"})]}),(0,t.jsxs)(A._2,{onClick:()=>(0,_.g9)(n,"unsubscribes.xml"),children:[(0,t.jsx)(N.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Export as XML"})]})]})]})]}),(0,t.jsx)(y.F,{className:"h-[600px]",children:(0,t.jsxs)(v.XI,{children:[(0,t.jsx)(v.A0,{className:"sticky top-0 bg-card",children:(0,t.jsxs)(v.Hj,{children:[(0,t.jsx)(v.nd,{children:"Email"}),(0,t.jsx)(v.nd,{children:"Status"}),(0,t.jsx)(v.nd,{children:"Date Unsubscribed"})]})}),(0,t.jsx)(v.BF,{children:i.map(e=>(0,t.jsxs)(v.Hj,{children:[(0,t.jsx)(v.nA,{className:"font-medium",children:e.EMAIL??"N/A"}),(0,t.jsx)(v.nA,{children:e.status}),(0,t.jsx)(v.nA,{children:(0,C.b)(e.date_added)})]},e.subscriber_uid))})]})}),0===i.length&&(0,t.jsx)("div",{className:"text-center p-8 text-muted-foreground",children:"No unsubscribed users found."})]})}var S=r(95775),M=r(33784),E=r(75535),z=r(73421);let F=(0,i.A)(function(){let[e,s]=(0,a.useState)([]),[r,i]=(0,a.useState)([]),[o,v]=(0,a.useState)(!0),[g,y]=(0,a.useState)(!1),[q,w]=(0,a.useState)(null),k=(0,b.useRouter)(),{toast:N}=(0,j.dj)(),A=(0,a.useCallback)(async()=>{v(!0),w(null);try{let e=(0,E.rJ)(M.db,"rawLists"),r=(0,E.rJ)(M.db,"rawUnsubscribes"),t=await (0,E.GG)((0,E.P)(e)),a=await (0,E.GG)((0,E.P)(r)),n=t.docs.map(e=>e.data()),o=a.docs.map(e=>e.data());o.sort((e,s)=>{let r=e.date_added?new Date(e.date_added).getTime():0;return(s.date_added?new Date(s.date_added).getTime():0)-r}),i(n),s(o)}catch(s){console.error("Failed to fetch data from Firestore:",s);let e=s.message||"Could not fetch data from Firestore.";w(e),N({title:"Failed to Load Data",description:e,variant:"destructive"})}finally{v(!1)}},[N]),_=(0,a.useCallback)(async()=>{y(!0),w(null);try{let e=await (0,z.X)();N({title:"Sync Successful",description:e.message})}catch(s){console.error("Sync failed:",s);let e=s.message||"Could not sync data from the API.";w(e),N({title:"Sync Failed",description:e,variant:"destructive"})}finally{y(!1),await A()}},[N,A]),C=async()=>{await (0,m.CI)(),k.push("/login")};return o&&0===e.length?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)(n.A,{className:"h-8 w-8 animate-spin"})}):(0,t.jsxs)("div",{className:"flex flex-col min-h-screen bg-background text-foreground",children:[(0,t.jsx)("header",{className:"sticky top-0 z-40 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,t.jsxs)("div",{className:"container flex h-16 items-center px-4 sm:px-6 lg:px-8",children:[(0,t.jsx)("div",{className:"mr-4 flex",children:(0,t.jsx)("h1",{className:"text-2xl font-bold text-primary",children:"Email Insights Pro"})}),(0,t.jsxs)("div",{className:"flex flex-1 items-center justify-end space-x-2",children:[(0,t.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>k.push("/"),children:[(0,t.jsx)(l,{className:"mr-2 h-4 w-4"}),"Dashboard"]}),(0,t.jsxs)(h.$,{variant:"default",size:"sm",onClick:_,disabled:g,children:[(0,t.jsx)(d.A,{className:`mr-2 h-4 w-4 ${g?"animate-spin":""}`}),g?"Syncing...":"Sync Unsubscribes"]}),(0,t.jsxs)(h.$,{variant:"outline",size:"sm",onClick:C,children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]})}),(0,t.jsx)("main",{className:"flex-1",children:(0,t.jsxs)("div",{className:"container py-8 px-4 sm:px-6 lg:px-8 space-y-8",children:[(0,t.jsx)("section",{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsx)(S.h,{title:"Total Unsubscribes",value:o?"...":e.length.toLocaleString(),icon:(0,t.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"}),footer:"From last sync"}),(0,t.jsx)(S.h,{title:"Number of Lists",value:o?"...":(r||[]).length.toLocaleString(),icon:(0,t.jsx)(x,{className:"h-4 w-4 text-muted-foreground"}),footer:"From last sync"})]})}),(0,t.jsxs)(f.Zp,{children:[(0,t.jsxs)(f.aR,{children:[(0,t.jsx)(f.ZB,{children:"All Unsubscribed Users"}),(0,t.jsx)(f.BT,{children:"This table shows a consolidated list of all users who have unsubscribed from any of your email lists, based on the last successful data sync from Firestore."})]}),(0,t.jsx)(f.Wu,{children:o&&!g?(0,t.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,t.jsx)(n.A,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("p",{className:"ml-4 text-muted-foreground",children:"Fetching data from database..."})]}):q?(0,t.jsxs)("div",{className:"bg-destructive/10 text-destructive p-4 rounded-md space-y-2",children:[(0,t.jsxs)("h4",{className:"font-semibold text-lg flex items-center gap-2",children:[(0,t.jsx)(p,{}),"Could not load data"]}),(0,t.jsx)("pre",{className:"text-sm overflow-x-auto whitespace-pre-wrap",children:q})]}):(0,t.jsx)(P,{data:e})})]})]})})]})})},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32467:e=>{"use strict";e.exports=require("node:http2")},33873:e=>{"use strict";e.exports=require("path")},34456:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var t=r(65239),i=r(48088),a=r(88170),n=r.n(a),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(s,l);let d={children:["",{children:["unsubscribes",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,54101)),"/home/user/studio/src/app/unsubscribes/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/unsubscribes/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/unsubscribes/page",pathname:"/unsubscribes",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},34589:e=>{"use strict";e.exports=require("node:assert")},34631:e=>{"use strict";e.exports=require("tls")},36406:(e,s,r)=>{Promise.resolve().then(r.bind(r,21546))},37067:e=>{"use strict";e.exports=require("node:http")},37366:e=>{"use strict";e.exports=require("dns")},37540:e=>{"use strict";e.exports=require("node:console")},41204:e=>{"use strict";e.exports=require("string_decoder")},41692:e=>{"use strict";e.exports=require("node:tls")},41792:e=>{"use strict";e.exports=require("node:querystring")},53053:e=>{"use strict";e.exports=require("node:diagnostics_channel")},54101:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/unsubscribes/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/unsubscribes/page.tsx","default")},55511:e=>{"use strict";e.exports=require("crypto")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73136:e=>{"use strict";e.exports=require("node:url")},73358:(e,s,r)=>{Promise.resolve().then(r.bind(r,54101))},73429:e=>{"use strict";e.exports=require("node:util/types")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},75919:e=>{"use strict";e.exports=require("node:worker_threads")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},78474:e=>{"use strict";e.exports=require("node:events")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var s=require("../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[447,724,611,30,246,215,361,184,67],()=>r(34456));module.exports=t})();